language: rust
rust: stable
env:
  global:
    - RUSTFLAGS="--deny warnings"

stages:
  - stylecheck
  - test

jobs:
  include:
    - stage: stylecheck
      script:
        - rustup component add rustfmt
        - cargo fmt --all -- --check
    - stage: test
      script:
        - cargo test --all-features --no-fail-fast --all

notifications:
  email:
    on_success: never
