<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `stafft` mod in crate `shallow_water`."><meta name="keywords" content="rust, rustlang, rust-lang, stafft"><title>shallow_water::stafft - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../shallow_water/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><p class="location">Module stafft</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#functions">Functions</a></li></ul></div><p class="location"><a href="../index.html">shallow_water</a></p><script>window.sidebarCurrent = {name: "stafft", ty: "mod", relpath: "../"};</script><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><span class="help-button">?</span>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/shallow_water/stafft/mod.rs.html#1-877" title="goto source code">[src]</a></span><span class="in-band">Module <a href="../index.html">shallow_water</a>::<wbr><a class="mod" href="">stafft</a></span></h1><div class="docblock"><p>Fourier transform module.
This is not a general purpose transform package but is designed to be
quick for arrays of length 2^n. It will work if the array length is of
the form 2^i * 3^j * 4^k * 5^l * 6^m (integer powers obviously).</p>
<p>Minimal error-checking is performed by the code below. The only check is that
the initial factorisation can be performed.
Therefore if the transforms are called with an array of length &lt;2, or a trig array
not matching the length of the array to be transformed the code will fail in a
spectacular way (eg. Seg. fault or nonsense returned).
It is up to the calling code to ensure everything is called sensibly.
The reason for stripping error checking is to speed up the backend by performing
less if() evaluations - as errors in practice seem to occur very rarely.
So the good news is this should be a fast library - the bad is that you may have to pick
around in it if there are failures.</p>
<p>To initialise the routines call init(n,factors,trig,ierr).
This fills a factorisation array (factors), and a sin/cos array (trig).
These must be kept in memory by the calling program.
The init routine can be called multiple times with different arrays if more than
one length of array is to be transformed.
If a factorisation of the array length n cannot be found (as specified above)
then the init routine will exit immediately and the integer ierr will be set to 1.
If the init returns with ierr=0 then the call was successful.</p>
<p>Top-level subroutines contained in this module are:</p>
<ol>
<li>initfft(n,factors,trig)        :
Performs intialisation of the module, by working out the factors of n (the FFT length).
This will fail if n is not factorised completely by 2,3,4,5,6.
The trig array contains the necessary cosine and sine values.
Both arrays passed to init <strong>must</strong> be kept between calls to routines in this module.</li>
<li>forfft(m,n,x,trig,factors)  :
This performs a FFT of an array x containing m vectors of length n.
The transform length is n.
This inverse of this transform is obtained by revfft.</li>
<li>revfft(m,n,x,trig,factors)  :
This performs an inverse FFT of an array x containing m vectors of length n.
The transform length is n.
This inverse of this transform is forfft.</li>
<li>dct(m,n,x,trig,factors)     :
This performs a discrete cosine transform of an array x containing m vectors of length n.
The transform length is n.
This routine calls forfft and performs pre- and post- processing to obtain the transform.
This transform is it's own inverse.</li>
<li>dst(m,n,x,trig,factors)     :
This performs a discrete sine transform of an array x containing m vectors of length n.
The transform length is n.
This routine calls forfft and performs pre- and post- processing to obtain the transform.
This transform is it's own inverse.</li>
</ol>
<p>The storage of the transformed array is in 'Hermitian form'. This means that, for the jth vector
the values x(j,1:nw) contain the cosine modes of the transform, while the values x(j,nw+1:n) contain
the sine modes (in reverse order ie. wave number increasing from n back to nw+1).
[Here, for even n, nw=n/2, and for odd n, nw=(n-1)/2].</p>
</div><h2 id="functions" class="section-header"><a href="#functions">Functions</a></h2>
<table><tr class="module-item"><td><a class="fn" href="fn.factorisen.html" title="shallow_water::stafft::factorisen fn">factorisen</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="fn" href="fn.forfft.html" title="shallow_water::stafft::forfft fn">forfft</a></td><td class="docblock-short"><p>Main physical to spectral (forward) FFT routine.
Performs m transforms of length n in the array x which is dimensioned x(m,n).
The arrays trig and factors are filled by the init routine and
should be kept from call to call.
Backend consists of mixed-radix routines, with 'decimation in time'.
Transform is stored in Hermitian form.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.forrdx2.html" title="shallow_water::stafft::forrdx2 fn">forrdx2</a></td><td class="docblock-short"><p>Radix two physical to Hermitian FFT with 'decimation in time'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.forrdx3.html" title="shallow_water::stafft::forrdx3 fn">forrdx3</a></td><td class="docblock-short"><p>Radix three physical to Hermitian FFT with 'decimation in time'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.forrdx4.html" title="shallow_water::stafft::forrdx4 fn">forrdx4</a></td><td class="docblock-short"><p>Radix four physical to Hermitian FFT with 'decimation in time'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.forrdx5.html" title="shallow_water::stafft::forrdx5 fn">forrdx5</a></td><td class="docblock-short"><p>Radix five physical to Hermitian FFT with 'decimation in time'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.forrdx6.html" title="shallow_water::stafft::forrdx6 fn">forrdx6</a></td><td class="docblock-short"><p>Radix six physical to Hermitian FFT with 'decimation in time'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.initfft.html" title="shallow_water::stafft::initfft fn">initfft</a></td><td class="docblock-short"><p>Subroutine performs initialisation work for all the transforms.
It calls routines to factorise the array length n and then sets up
a trig array full of sin/cos values used in the transform backend.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.revfft.html" title="shallow_water::stafft::revfft fn">revfft</a></td><td class="docblock-short"><p>Main spectral to physical (reverse) FFT routine.
Performs m reverse transforms of length n in the array x which is dimensioned x(m,n).
The arrays trig and factors are filled by the init routine and
should be kept from call to call.
Backend consists of mixed-radix routines, with 'decimation in frequency'.
Reverse transform starts in Hermitian form.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.revrdx2.html" title="shallow_water::stafft::revrdx2 fn">revrdx2</a></td><td class="docblock-short"><p>Radix two Hermitian to physical FFT with 'decimation in frequency'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.revrdx3.html" title="shallow_water::stafft::revrdx3 fn">revrdx3</a></td><td class="docblock-short"><p>Radix three Hermitian to physical FFT with 'decimation in frequency'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.revrdx4.html" title="shallow_water::stafft::revrdx4 fn">revrdx4</a></td><td class="docblock-short"><p>Radix four Hermitian to physical FFT with 'decimation in frequency'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.revrdx5.html" title="shallow_water::stafft::revrdx5 fn">revrdx5</a></td><td class="docblock-short"><p>Radix five Hermitian to physical FFT with 'decimation in frequency'.</p>
</td></tr><tr class="module-item"><td><a class="fn" href="fn.revrdx6.html" title="shallow_water::stafft::revrdx6 fn">revrdx6</a></td><td class="docblock-short"><p>Radix six Hermitian to physical FFT with 'decimation in frequency'.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><script>window.rootPath = "../../";window.currentCrate = "shallow_water";</script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>